<%= form_for @report, url: {action: @report.new_record? ? :create : :update} do |f| %>

  <%= render partial: "errors", locals: { object: @report } %>

  <table class="formTbl contents">
    <tr>
      <th width= "15%"><%= f.label :categoty_id %></th>
      
      <td>
        <% ReportCategory.all.each_with_index do |category, index| %>
          <% if @report.report_category_id.blank? && index ==0 %>
            <%= f.radio_button :report_category_id, category.id ,checked: true %> &nbsp; <%= f.label "report_category_id_#{category.id}", category.name %>
          <% else %>
            <%= f.radio_button :report_category_id, category.id %> &nbsp; <%= f.label "report_category_id_#{category.id}", category.name %>
          <% end %>
        <% end %>
      </td>
    </tr>
    <tr style= "display:none;" id = "tr_user_support">
      <th><%= f.label :user_name %></th>
      <td>
        <%= text_field_tag :tags %>
        <div class="tag-badge">
          <% if @report.support_users.present? %>
            <% @report.support_users.each do |user| %>
              <span class="tag-name"><%= User.find(user.user_id).display_name %>&nbsp;<img class="clear_support" src="/assets/ico_tag_delete.png" data-id = "<%= user.user_id %>"></span>
            <% end %>
          <% end %>
        </div>
        <%= hidden_field_tag :support_users, @report.support_users.present? ? @report.support_users.pluck(:user_id).join(',') : "", "data-name_nested_attributes" => "report[support_users_attributes]" %>
        <div id = "div_support_users">
          <% @report.support_users && @report.support_users.each_with_index do |support_user, i| %>
            <%= render "support_users_fields", {support_user: support_user, f: f , id: support_user.user_id, time: Time.now.to_i} %>
          <% end %>
        </div>
      </td>
    </tr>
    <tr>
      <th><%= f.label :report_date %></th>
      <td><%= f.text_field :report_date %></td>
    </tr>
    <tr>
      <th><%= f.label :title %></th>
      <td><%= f.text_field :title, style:"width:98.6%" %></td>
    </tr>
    <tr>
      <th><%= f.label :description %></th>
      <td><%= f.text_area :description, style: "width:100%; height:100px;"  %></td>
    </tr>
    
  </table>
  <div class="form-actions">
    <%= f.submit @report.new_record? ? I18n.t(:button_create, scope: [:views, :labels]) : I18n.t(:button_edit, scope: [:views, :labels]), class:"btn btn-primary" %>
  </div>
<% end %>
